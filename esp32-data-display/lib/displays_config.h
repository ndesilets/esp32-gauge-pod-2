// display_config.h
#pragma once
#ifndef DISPLAYS_CONFIG_H
#define DISPLAYS_CONFIG_H
#include <Arduino_GFX_Library.h>

#include "i2c.h"

struct DisplayConfig {
  const char* name;

  uint32_t hsync_pulse_width;
  uint32_t hsync_back_porch;
  uint32_t hsync_front_porch;
  uint32_t vsync_pulse_width;
  uint32_t vsync_back_porch;
  uint32_t vsync_front_porch;
  uint32_t prefer_speed;
  uint32_t lane_bit_rate;

  uint16_t width;
  uint16_t height;
  int8_t rotation;
  bool auto_flush;
  int8_t rst_pin;

  const lcd_init_cmd_t* init_cmds;
  size_t init_cmds_size;

  int8_t i2c_sda_pin;
  int8_t i2c_scl_pin;
  uint32_t i2c_clock_speed;
  int8_t lcd_rst;
};

static const lcd_init_cmd_t vendor_specific_init_default[] = {
    {0xB9, (uint8_t[]){0xF1, 0x12, 0x83}, 3, 0},

    {0xBA, (uint8_t[]){0x31, 0x81, 0x05, 0xF9, 0x0E, 0x0E, 0x20, 0x00, 0x00,
                       0x00, 0x00, 0x00, 0x00, 0x00, 0x44, 0x25, 0x00, 0x90,
                       0x0A, 0x00, 0x00, 0x01, 0x4F, 0x01, 0x00, 0x00, 0x37},
     27, 0},
    {0xB8, (uint8_t[]){0x25, 0x22, 0xF0, 0x63}, 4, 0},

    {0xBF, (uint8_t[]){0x02, 0x11, 0x00}, 3, 0},

    {0xB3,
     (uint8_t[]){0x10, 0x10, 0x28, 0x28, 0x03, 0xFF, 0x00, 0x00, 0x00, 0x00},
     10, 0},

    {0xC0, (uint8_t[]){0x73, 0x73, 0x50, 0x50, 0x00, 0x00, 0x12, 0x70, 0x00}, 9,
     0},

    {0xBC, (uint8_t[]){0x46}, 1, 0},
    {0xCC, (uint8_t[]){0x0B}, 1, 0},
    {0xB4, (uint8_t[]){0x80}, 1, 0},
    {0xB2, (uint8_t[]){0x3C, 0x12, 0x30}, 3, 0},
    {0xE3,
     (uint8_t[]){0x07, 0x07, 0x0B, 0x0B, 0x03, 0x0B, 0x00, 0x00, 0x00, 0x00,
                 0xFF, 0x00, 0xC0, 0x10},
     14, 0},
    {0xC1,
     (uint8_t[]){0x36, 0x00, 0x32, 0x32, 0x77, 0xF1, 0xCC, 0xCC, 0x77, 0x77,
                 0x33, 0x33},
     12, 0},
    {0xB5, (uint8_t[]){0x0A, 0x0A}, 2, 0},
    {0xB6, (uint8_t[]){0xB2, 0xB2}, 2, 0},
    {0xE9, (uint8_t[]){0xC8, 0x10, 0x0A, 0x10, 0x0F, 0xA1, 0x80, 0x12, 0x31,
                       0x23, 0x47, 0x86, 0xA1, 0x80, 0x47, 0x08, 0x00, 0x00,
                       0x0D, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0D, 0x00, 0x00,
                       0x00, 0x48, 0x02, 0x8B, 0xAF, 0x46, 0x02, 0x88, 0x88,
                       0x88, 0x88, 0x88, 0x48, 0x13, 0x8B, 0xAF, 0x57, 0x13,
                       0x88, 0x88, 0x88, 0x88, 0x88, 0x00, 0x00, 0x00, 0x00,
                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00},
     63, 0},
    {0xEA, (uint8_t[]){0x96, 0x12, 0x01, 0x01, 0x01, 0x78, 0x02, 0x00, 0x00,
                       0x00, 0x00, 0x00, 0x4F, 0x31, 0x8B, 0xA8, 0x31, 0x75,
                       0x88, 0x88, 0x88, 0x88, 0x88, 0x4F, 0x20, 0x8B, 0xA8,
                       0x20, 0x64, 0x88, 0x88, 0x88, 0x88, 0x88, 0x23, 0x00,
                       0x00, 0x01, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                       0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
                       0x40, 0xA1, 0x80, 0x00, 0x00, 0x00, 0x00},
     61, 0},
    {0xE0, (uint8_t[]){0x00, 0x0A, 0x0F, 0x29, 0x3B, 0x3F, 0x42, 0x39, 0x06,
                       0x0D, 0x10, 0x13, 0x15, 0x14, 0x15, 0x10, 0x17, 0x00,
                       0x0A, 0x0F, 0x29, 0x3B, 0x3F, 0x42, 0x39, 0x06, 0x0D,
                       0x10, 0x13, 0x15, 0x14, 0x15, 0x10, 0x17},
     34, 0},

    {0x11, (uint8_t[]){0x00}, 1, 250},
    {0x29, (uint8_t[]){0x00}, 1, 50},
};

const DisplayConfig SCREEN_DEFAULT = {
    .name = "10.1-DSI-TOUCH-A",
    .hsync_pulse_width = 20,
    .hsync_back_porch = 80,
    .hsync_front_porch = 80,
    .vsync_pulse_width = 4,
    .vsync_back_porch = 12,
    .vsync_front_porch = 30,
    .prefer_speed = 46000000,
    .lane_bit_rate = 1000,
    .width = 720,
    .height = 720,
    .rotation = 0,
    .auto_flush = true,
    .rst_pin = -1,
    .init_cmds = vendor_specific_init_default,
    .init_cmds_size =
        sizeof(vendor_specific_init_default) / sizeof(lcd_init_cmd_t),
    .i2c_sda_pin = 7,
    .i2c_scl_pin = 8,
    .i2c_clock_speed = 100000,
    .lcd_rst = 27,
};

inline const DisplayConfig& display_cfg = SCREEN_DEFAULT;
#endif